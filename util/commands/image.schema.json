{
    "$id": "https://kulturkrock.se/commands/image.schema.json",
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Image commands in Opus",
    "description": "An image command in an Opus to use for Screencrash",
    "type": "object",
    "oneOf": [
        {
            "title": "Sync asset",
            "description": "Sync asset to screen component resource folder. Don't do this in an Opus.",
            "properties": {
                "target": { "const": "image" },
                "cmd": { "const": "file" },
                "desc": {
                    "title": "Description",
                    "description": "Description of what this action do",
                    "type": "string"
                },
                "params": {
                    "type": "object",
                    "properties": {
                        "path": {
                            "title": "Asset path",
                            "description": "Destination path to asset relative to resource folder",
                            "type": "string"
                        },
                        "data": {
                            "title": "Data",
                            "description": "Base64 encoded data",
                            "type": "string"
                        }
                    },
                    "required": ["path", "data"],
                    "additionalProperties": false
                }
            },
            "required": ["target", "cmd", "params"],
            "additionalProperties": false
        },
        {
            "title": "Add an image",
            "description": "Adds an image and loads it into its own viewer",
            "properties": {
                "target": { "const": "image" },
                "cmd": { "const": "create" },
                "desc": {
                    "title": "Description",
                    "description": "Description of what this action do",
                    "type": "string"
                },
                "assets": {
                    "title": "Asset",
                    "description": "Asset to show. This command expects exactly ONE asset",
                    "type": "array",
                    "items": {
                        "oneOf":[
                            {
                                "title": "Asset ID",
                                "type": "string"
                            },
                            {"$ref": "../asset.schema.json#"}
                        ]
                    },
                    "minLength": 1,
                    "maxLength": 1
                },
                "params": {
                    "type": "object",
                    "properties": {
                        "entityId": {
                            "title": "Entity ID",
                            "description": "Entity ID to use for this clip. Subsequent commands uses this ID to refer to this instance",
                            "type": "string"
                        },
                        "displayName": {
                            "title": "Display name",
                            "description": "Name to use in UI etc. If no name is given, the name will be autogenerated from the asset name",
                            "type": "string"
                        },
                        "x": {
                            "title": "Horizontal position",
                            "description": "Horizontal position along x-axis, given in either pixels or percent (see usePercentage param)",
                            "type": "number"
                        },
                        "y": {
                            "title": "Vertical position",
                            "description": "Vertical position along y-axis, given in either pixels or percent (see usePercentage param)",
                            "type": "number"
                        },
                        "width": {
                            "title": "Width of clip",
                            "description": "Width of clip, given in either pixels or percentage (see usePercentage param)",
                            "type": "number"
                        },
                        "height": {
                            "title": "Height of clip",
                            "description": "Height of clip, given in either pixels or percentage (see usePercentage param)",
                            "type": "number"
                        },
                        "usePercentage": {
                            "title": "Unit to use",
                            "description": "If true, parameters x, y, width and height are applied with % as unit. If false, pixels are used instead",
                            "type": "boolean",
                            "default": false
                        },
                        "opacity": {
                            "title": "Opacity",
                            "description": "Opacity of clip. This has nothing to do with the parameter visible/visibility",
                            "type": "number",
                            "minimum": 0.0,
                            "maximum": 1.0,
                            "default": 1.0
                        },
                        "layer": {
                            "title": "Layer",
                            "description": "Layer of clip. Higher layer means closer to user",
                            "type": "number",
                            "minimum": 0,
                            "default": 0
                        },
                        "visible": {
                            "title": "Visibility",
                            "description": "If true, image element is shown. If false, it is hidden",
                            "type": "boolean",
                            "default": false
                        },
                        "fadeIn": {
                            "title": "Fade in",
                            "description": "Fade in image when added",
                            "type": "object",
                            "properties": {
                                "time": {
                                    "title": "Fade duration",
                                    "description": "Time to fade from start opacity to target opacity",
                                    "type": "number"
                                },
                                "from": {
                                    "title": "Start opacity",
                                    "description": "Start opacity. If not given the current opacity will be used",
                                    "type": "number",
                                    "minimum": 0.0,
                                    "maximum": 1.0
                                },
                                "to": {
                                    "title": "Target opacity",
                                    "description": "Target opacity to reach after {time} seconds",
                                    "type": "number",
                                    "minimum": 0.0,
                                    "maximum": 1.0
                                }
                            },
                            "required": ["time", "to"],
                            "additionalProperties": false
                        }
                    },
                    "required": [],
                    "additionalProperties": false
                }
            },
            "required": ["target", "cmd", "assets"],
            "additionalProperties": false
        },
        {
            "title": "Destroy image viewer",
            "description": "Destroy image viewer",
            "properties": {
                "target": { "const": "image" },
                "cmd": { "const": "destroy" },
                "desc": {
                    "title": "Description",
                    "description": "Description of what this action do",
                    "type": "string"
                },
                "params": {
                    "type": "object",
                    "properties": {
                        "entityId": {
                            "title": "Entity ID",
                            "description": "Entity ID of the clip",
                            "type": "string"
                        }
                    },
                    "required": ["entityId"],
                    "additionalProperties": false
                }
            },
            "required": ["target", "cmd", "params"],
            "additionalProperties": false
        },
        {
            "title": "Set image visible",
            "description": "Set clip visibility to be visible",
            "properties": {
                "target": { "const": "image" },
                "cmd": { "const": "show" },
                "desc": {
                    "title": "Description",
                    "description": "Description of what this action do",
                    "type": "string"
                },
                "params": {
                    "type": "object",
                    "properties": {
                        "entityId": {
                            "title": "Entity ID",
                            "description": "Entity ID of the clip",
                            "type": "string"
                        }
                    },
                    "required": ["entityId"],
                    "additionalProperties": false
                }
            },
            "required": ["target", "cmd", "params"],
            "additionalProperties": false
        },
        {
            "title": "Set image hidden",
            "description": "Set clip visibility to be hidden",
            "properties": {
                "target": { "const": "image" },
                "cmd": { "const": "hide" },
                "desc": {
                    "title": "Description",
                    "description": "Description of what this action do",
                    "type": "string"
                },
                "params": {
                    "type": "object",
                    "properties": {
                        "entityId": {
                            "title": "Entity ID",
                            "description": "Entity ID of the clip",
                            "type": "string"
                        }
                    },
                    "required": ["entityId"],
                    "additionalProperties": false
                }
            },
            "required": ["target", "cmd", "params"],
            "additionalProperties": false
        },
        {
            "title": "Set opacity on image",
            "description": "Set opacity of clip",
            "properties": {
                "target": { "const": "image" },
                "cmd": { "const": "opacity" },
                "desc": {
                    "title": "Description",
                    "description": "Description of what this action do",
                    "type": "string"
                },
                "params": {
                    "type": "object",
                    "properties": {
                        "entityId": {
                            "title": "Entity ID",
                            "description": "Entity ID of the clip",
                            "type": "string"
                        },
                        "opacity": {
                            "title": "Opacity",
                            "description": "Opacity of clip",
                            "type": "number",
                            "minimum": 0.0,
                            "maximum": 1.0
                        }
                    },
                    "required": ["entityId", "opacity"],
                    "additionalProperties": false
                }
            },
            "required": ["target", "cmd", "params"],
            "additionalProperties": false
        },
        {
            "title": "Set viewport for image",
            "description": "Set clip viewport dimensions",
            "properties": {
                "target": { "const": "image" },
                "cmd": { "const": "viewport" },
                "desc": {
                    "title": "Description",
                    "description": "Description of what this action do",
                    "type": "string"
                },
                "params": {
                    "type": "object",
                    "properties": {
                        "entityId": {
                            "title": "Entity ID",
                            "description": "Entity ID of the clip",
                            "type": "string"
                        },
                        "x": {
                            "title": "Horizontal position",
                            "description": "Horizontal position along x-axis, given in either pixels or percent (see usePercentage param)",
                            "type": "number"
                        },
                        "y": {
                            "title": "Vertical position",
                            "description": "Vertical position along y-axis, given in either pixels or percent (see usePercentage param)",
                            "type": "number"
                        },
                        "width": {
                            "title": "Width of clip",
                            "description": "Width of clip, given in either pixels or percentage (see usePercentage param)",
                            "type": "number"
                        },
                        "height": {
                            "title": "Height of clip",
                            "description": "Height of clip, given in either pixels or percentage (see usePercentage param)",
                            "type": "number"
                        },
                        "usePercentage": {
                            "title": "Unit to use",
                            "description": "If true, parameters x, y, width and height are applied with % as unit. If false, pixels are used instead",
                            "type": "boolean",
                            "default": false
                        }
                    },
                    "required": ["entityId"],
                    "anyOf": [
                        { "required": ["x"] },
                        { "required": ["y"] },
                        { "required": ["width"] },
                        { "required": ["height"] }
                    ],
                    "additionalProperties": false
                }
            },
            "required": ["target", "cmd", "params"],
            "additionalProperties": false
        },
        {
            "title": "Set layer for image",
            "description": "Set clip layer",
            "properties": {
                "target": { "const": "image" },
                "cmd": { "const": "layer" },
                "desc": {
                    "title": "Description",
                    "description": "Description of what this action do",
                    "type": "string"
                },
                "params": {
                    "type": "object",
                    "properties": {
                        "entityId": {
                            "title": "Entity ID",
                            "description": "Entity ID of the clip",
                            "type": "string"
                        },
                        "layer": {
                            "title": "Layer",
                            "description": "Layer of clip. Higher layer means closer to user",
                            "type": "number",
                            "minimum": 0
                        }
                    },
                    "required": ["entityId", "layer"],
                    "additionalProperties": false
                }
            },
            "required": ["target", "cmd", "params"],
            "additionalProperties": false
        },
        {
            "title": "Fade image",
            "description": "Fade image",
            "properties": {
                "target": { "const": "image" },
                "cmd": { "const": "fade" },
                "desc": {
                    "title": "Description",
                    "description": "Description of what this action do",
                    "type": "string"
                },
                "params": {
                    "type": "object",
                    "properties": {
                        "entityId": {
                            "title": "Entity ID",
                            "description": "Entity ID of the clip",
                            "type": "string"
                        },
                        "time": {
                            "title": "Fade time",
                            "description": "Fade time in seconds. May be float",
                            "type": "number"
                        },
                        "target": {
                            "title": "Target opacity",
                            "description": "Opacity to fade to",
                            "type": "number",
                            "minimum": 0.0,
                            "maximum": 1.0
                        },
                        "stopOnDone": {
                            "title": "Stop clip after fade",
                            "description": "Stop clip and destruct its wrapper after fade has completed. Defaults to false",
                            "type": "boolean"
                        }
                    },
                    "required": ["entityId", "time", "target"],
                    "additionalProperties": false
                }
            },
            "required": ["target", "cmd", "params"],
            "additionalProperties": false
        }
    ]
}